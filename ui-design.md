# K12 教务管理系统 - UI布局与交互设计（文字线框稿）

说明：本文件聚焦“各页面详细布局 + 关键交互”，用于研发直接照着实现。不输出高保真视觉稿；视觉与动效基线采用“方案A（Tailwind + Radix UI + shadcn/ui + Framer Motion）”，并以设计系统为准：[design-system.md](file:///c:/Users/14590/Desktop/%E6%95%99%E5%8A%A12/design-system.md)。

## 1. 全局设计规范
### 1.1 端与布局
- 管理端/教师端（PC）：左侧侧边栏（可收起）+ 顶部栏 + 内容区（Card/表格/图表）。
- 学生端（H5）：底部 Tab（首页/成绩/德育/填报/我的），顶部为标题栏。
- 分布屏（TV）：全屏滚动，分区块轮播，禁止复杂交互。

### 1.2 顶部栏（PC）
- 左侧：系统Logo + 系统名
- 中部：学年学期选择器（默认当前）+ 年级选择器（按权限显示）
- 右侧：全局搜索（学生：姓名/学号）+ 通知铃铛（可选）+ 个人头像下拉（我的/退出）

### 1.3 列表页通用结构（PC）
- PageHeader：标题 + 右侧主操作按钮（新建/导入/导出/发布）
- FilterBar：折叠筛选（默认展示3-5个最常用筛选）
- Table：支持列配置（可选）、固定操作列、分页、行选择（批量）
- Drawer/Modal：用于“查看详情/编辑/预览差异/导入错误行”

### 1.4 详情页通用结构（PC）
- 左侧 InfoCard：头像/关键信息/标签
- 中间 Main：Tabs（概览/明细/趋势/记录）
- 右侧 ActionCard：快捷操作（导出、标记、发起流程）

### 1.5 状态与反馈
- 导入类操作全部走“任务中心”：
  - 上传后立即返回 taskId
  - 页面显示任务进度条 + 错误行下载按钮
- 高风险操作（回滚导入、撤销德育事件、权限发布）必须二次确认，并展示审计提示。

---

## 2. 登录与我的
### 2.1 登录页（PC/H5）
- 布局：
  - 居中 Card：账号、密码、图形验证码（可选）
  - 底部：版权信息
- 交互：
  - 回车提交
  - 登录成功：跳转默认首页（按角色）
  - 首次登录/管理员重置密码后：强制跳转修改密码页

### 2.2 我的（PC）
- 布局：Modal 或独立页面
- 区块：
  - 基本信息（只读）
  - 修改密码表单
- 交互：保存成功 toast + 自动登出（可选策略）

---

## 3. 管理端（PC）

### 3.1 工作台
- 布局：三列栅格
  - 左：待办/待处理（审批、复核）
  - 中：导入任务卡（用户/成绩/德育）
  - 右：预警摘要（临界生数量、德育Top扣分班级）
- 交互：点击卡片跳转对应列表并带筛选参数

### 3.2 组织与人员

#### 3.2.1 年级管理
- 页面结构：FilterBar（状态） + Table（年级） + Drawer（编辑）
- 表格列：
  - 年级（2024级）、入学年份、状态、操作（编辑/停用）
- 交互：
  - 停用：二次确认 + 审计提示

#### 3.2.2 班级管理
- 页面结构：FilterBar（年级/学期） + Table（班级） + Drawer（班级详情）
- Drawer（班级详情）Tabs：
  - 基本信息：班主任选择器、班级名称
  - 科任老师：学科 -> 老师（可多行配置）
- 交互：
  - “分配班主任”走选择器弹窗，保存后立即生效

#### 3.2.3 用户管理（学生为主）
- 页面结构：顶部主按钮区（导入/批量重置密码/导出） + FilterBar + Table + 导入Wizard
- Table 默认列：
  - 姓名、学号、年级、班级、状态、上次登录、操作（详情/停用/重置密码）
- 详情 Drawer：
  - 基本信息（不可变：学号/姓名/性别/入学年份）
  - 可变信息（班级/宿舍/座位/走读住校）只读展示
  - 权限与范围（只读展示，跳转到“角色权限”配置）
- 导入 Wizard（3步）：
  1) 上传文件：下载模板、上传、显示字段说明
  2) 预校验结果：错误行表格（可筛选错误类型）+ 下载错误报告
  3) 确认导入：展示“将新增/将更新/将跳过”统计 + 开始导入按钮
- 交互：
  - 同名：允许；搜索命中同名时列表必须展示学号与班级
  - 学号冲突：在预校验阶段提示“更新/跳过/报错”策略（开关）

---

### 3.3 角色权限
#### 3.3.1 角色管理
- 页面：左侧角色列表 + 右侧角色详情（类似设置页）
- 右侧 Tabs：
  - 菜单权限（树勾选）
  - 功能权限（按页面分组的 checkbox 列表）
  - 默认数据范围（可选）
- 交互：
  - 支持“复制角色”
  - 保存后提示“已生效/需重新登录生效”（策略可配置）

#### 3.3.2 用户数据范围授权
- 页面：用户详情 - 数据范围
- 布局：三块选择器
  - 年级多选
  - 行政班多选（可按年级过滤）
  - 学科多选（仅教师）
- 交互：保存立即生效；记录审计

---

### 3.4 考务与成绩中心
#### 3.4.1 考试批次管理
- 页面结构：FilterBar（学期/年级/类型/状态）+ Table + Drawer（考试详情）
- Drawer（考试详情）：
  - 基本信息：名称、类型（月考/期中/期末）、年级、学期
  - 科目配置（Tab）：
    - 列表：科目、满分、权重（可选）、是否统计（如体育可能不计入总分）
    - 操作：添加科目（多选）、批量设置满分
- 主操作：
  - 新建考试（Modal）：必须先选年级，再选科目
  - 发布/归档（按钮）：归档后不可再修改成绩，需二次确认

#### 3.4.2 成绩导入 Wizard（核心复杂交互）
#### 3.4.1 页面目标
- 让管理员能准确导入各科成绩，处理“科目列识别”与“学生重名”两大难题。

#### 3.4.2 步骤流程（Wizard Steps）
1.  **上传与配置**：选择考试批次 -> 上传 Excel -> 选择“模板导入”或“自定义映射”。
2.  **列映射（自定义模式）**：系统尝试自动识别列名（如“语文”-> `chinese`），用户手动修正未识别列。
3.  **数据校验与重名处理**：
    - 校验规则：学籍号/考号唯一（优先）、满分/零分逻辑、科目列完整性。
    - **重名处理交互（重点）**：
        - 场景：Excel 中仅有“张三”，系统中有两个“张三”。
        - 策略：
            1.  优先匹配 Excel 中的辅助列（如学籍号/考号/班级）。
            2.  若无法区分，弹窗列出冲突行，让管理员手动选择（显示：张三 | 高一1班 | 学号001 vs 张三 | 高一2班 | 学号002）。
            3.  支持“暂不导入该行”或“修正 Excel 后重新上传该行”。
4.  **预览与提交**：展示本次导入的摘要（总人数/科目数/缺考数/重名解决数），提交入库触发计算。

#### 3.4.3 关键 UI 细节
- **列映射器**：左侧为 Excel 列名（卡片），右侧为系统科目槽位（卡片），支持拖拽连线或下拉选择。
- **重名冲突弹窗**：
    - 标题：发现 N 个同名学生无法自动匹配
    - 列表：左侧 Excel 数据（张三/98分），右侧系统候选人（单选框：张三A/张三B）。
    - 底部：全部忽略 / 确认匹配。
- **反馈**：
    - 进度条（真实进度，非假动画）。
    - 错误报告下载（保留原 Excel 格式，仅在错误行后追加错误原因列）。

#### 3.4.3 成绩管理与修正
- 页面：成绩明细表（Filter：考试/班级/科目/学生）
- 列：学生信息、各科分数、总分、班排、级排、状态
- 操作：
  - 单条修正：点击分数 -> 弹窗修改 -> 填写原因（审计必填）
  - 批量删除/作废：二次确认 + 审计提示
  - 重新计算：若手动修改了分数，需手动触发“重新排名”按钮


---

### 3.5 德育量化中心
#### 3.5.1 德育规则配置
- 页面：规则列表（Filter：年级）
- 列：项目名称（如“内务不整”）、类别（纪律/内务/仪容）、默认分值（-1）、适用年级
- 操作：新建/编辑/启用/停用
- 预警配置（Tab）：
  - 累计阈值：学期累计扣分 > N 分（按年级配置）
  - 频次阈值：7天内连续扣分 > M 次
  - 触发动作：自动生成“重点关注”标签、通知班主任

#### 3.5.2 德育事件管理
- 页面结构：FilterBar（时间/来源/年级/班级/学生搜索）+ Table + Drawer（事件详情）
- Table 列：
  - 时间、学生（姓名+学号+班级）、来源（巡堂/纪检/宿舍/课堂）、项目、分值、状态
- 操作：
  - 新增事件（单条）：弹窗选择学生（支持多选）-> 选择项目 -> 填备注
  - 批量导入（Wizard）：下载模板 -> 上传 -> 校验 -> 提交
  - 撤销/更正：点击行操作 -> 填写原因 -> 二次确认（审计）

#### 3.5.3 德育统计报表
- 页面 Tabs：班级对比 / 学生榜单 / 来源分析
- 班级对比：柱状图（人均扣分），点击钻取到该班级详情
- 学生榜单：扣分最多 Top 50，支持导出
- 来源分析：饼图（巡堂占比 vs 宿舍占比），帮助德育处优化管理重点


---

### 3.6 低代码中心（自研）
#### 3.6.1 表单列表
- Table 列：表单名、code、状态、版本、最近发布人/时间、操作（编辑/复制/发布/归档/数据）
- 交互：
  - 发布：弹窗选择可见范围（年级/班级/角色）+ 版本说明

#### 3.6.2 表单设计器（MVP）
- 三栏布局：
  - 左：字段库（文本/数字/选择/日期/上传）
  - 中：画布（按行布局的表单预览，可拖拽排序）
  - 右：属性面板（字段名、字段code、必填、校验规则、字典来源）
- 顶部工具条：预览、保存草稿、发布

#### 3.6.3 通用对象（Entity）配置
- 对象列表：新建/编辑/发布/归档
- 对象编辑页 Tabs：
  - 字段管理（表格编辑）
  - 列表配置（列显示/过滤项）
  - 表单配置（布局/校验）
  - 权限与范围（读/写范围）

---

### 3.7 功能配置（菜单与页面）
#### 3.7.1 菜单树配置
- 布局：左侧树（可拖拽排序）+ 右侧属性表单
- 右侧字段：
  - 端类型（管理/教师/学生）
  - 名称、图标、排序、父级
  - 页面类型（内置/通用CRUD/外链）
  - 绑定权限点
- 交互：
  - 发布：版本差异预览（新增/删除/改名/移动）+ 回滚入口

---

## 4. 教师端（PC）
### 4.1 工作台
- 上部：我负责的班级卡片（点击进入班级管理）
- 下部：两列
  - 左：临界生摘要（Top10）
  - 右：德育预警摘要（Top10）

### 4.2 班级管理（班主任）
- 页面结构：班级信息条 + 学生表格 + 编辑弹窗
- 学生表格列：
  - 姓名、学号、座位号、宿舍、走读/住校、操作（编辑）
- 编辑弹窗：
  - 座位号、走读/住校、宿舍楼栋/房间/床位、生效学期
- 交互：
  - 保存即写入档案历史快照，并提示“已记录审计”

### 4.3 学生档案360
#### 4.3.1 页面目标
- 一屏内让班主任判断：学生当前状态、近阶段成绩走势、德育风险点、档案变动与需要采取的动作。

#### 4.3.2 页面骨架（两栏 + 吸顶信息条）
- 吸顶信息条（Sticky Header）：
  - 左：返回、学生姓名、学号（可复制）、当前行政班
  - 中：标签 Chips（临界生/偏科/重点关注/住校/走读）
  - 右：快捷操作（导出成绩单、查看审计、更多）
- 主体两栏：
  - 左栏（宽 320-360）：玻璃 InfoCard（头像、基础信息、当期状态、快捷入口）
  - 右栏（自适应）：Tabs 内容区（成绩/德育/档案/备注）

#### 4.3.3 左栏 InfoCard（玻璃容器 + 实心内容区）
- 玻璃容器：使用设计系统 glass tokens，外层模糊与边框；内部信息区使用更实的 surface 以保证可读性。
- 区块A：头像与身份
  - 头像（证件照占位）、姓名、学号
  - 右侧小标签：性别、入学年份、当前年级
- 区块B：当前可变信息（以当前学期快照为准）
  - 行1：行政班、座位号
  - 行2：宿舍（楼栋-房间-床位）、走读/住校
- 区块C：本周/本月摘要（小指标卡）
  - 成绩：最近一次考试总分（或名次，若对教师开放）
  - 德育：本周扣分合计、最高频来源（巡堂/纪检/宿舍/课堂）
- 区块D：快捷入口（按钮组）
  - “编辑可变信息”（若有权限）
  - “查看班级分析中的位置”（跳转并带 studentId）

#### 4.3.4 右栏 Tabs 结构
- Tabs：成绩 / 德育 / 档案 / 备注
- Tabs 头部右侧：过滤器（按 Tab 不同而变化），统一放在同一行以减少页面跳动。

##### A. 成绩 Tab
- 顶部过滤器：
  - 学期选择（默认当前）
  - 视图切换 Segmented：按考试 / 按学期
- 模块1：趋势卡（折线）
  - 指标切换：总分 / 年级名次 / 班级名次（是否展示由权限控制）
  - Hover tooltip：考试名称、各科分、名次变化（若可用）
- 模块2：单次考试成绩表
  - 列：科目、分数、班排、级排、是否缺考
  - 行内弱提示：该科均分对比（可选增强）
- 模块3：偏科雷达（可选增强）
  - 仅当科目数 >= 3 时展示

##### B. 德育 Tab
- 顶部过滤器：
  - 时间范围（本周/本月/自定义）
  - 来源多选（巡堂/纪检/宿舍/课堂）
- 模块1：累计与预警
  - 指标卡：扣分合计、涉及次数、最高频项目
  - 预警条：如“7天内连续扣分 ≥ N 次”（规则来自配置）
- 模块2：时间轴列表（主）
  - 每条卡片：时间、来源、项目、分值、备注、录入人
  - 状态：已撤销/待复核需明显标记
  - 操作：查看详情（是否允许更正由权限控制，默认班主任只读）

##### C. 档案 Tab（学期回溯）
- 顶部过滤器：
  - 学期选择（默认显示最近 6 个学期）
- 模块1：学期快照表
  - 列：学期、行政班、宿舍、座位、走读/住校、变更人、变更时间
  - 操作：查看审计（跳转审计日志并过滤 resourceId）

##### D. 备注 Tab（班主任工作记录，可选）
- 用途：记录谈话要点、关注点（可后续纳入“处置流程”）
- 形态：富文本可选，MVP 先用多行文本 + 时间戳记录

#### 4.3.5 关键交互与状态
- 首屏加载：左栏骨架屏 + 右栏 Tabs 骨架屏；接口并行请求，先渲染基本信息再渲染图表。
- 错误态：右栏模块级错误，不影响左栏；提供“重试”按钮。
- 空态：
  - 无成绩：显示“暂无成绩数据/等待导入”
  - 无德育：显示“暂无德育事件”
- 编辑可变信息（班主任）：
  - 从左栏按钮进入 Modal/Drawer
  - 保存成功：toast + 自动刷新左栏与档案 Tab
  - 必须提示“已记录审计”
  - 锁冲突：若同一学生被并发修改，提示“已被更新，请刷新”

#### 4.3.6 视觉与动效落地（方案A）
- Sticky Header：半透明玻璃条 + 轻阴影，滚动时边框透明度略提升。
- Tabs 切换：内容区淡入 160ms，保持稳定高度（避免跳动）。
- 指标卡与 chips：hover 仅轻微提亮与描边，不做夸张缩放。

### 4.4 班级分析（核心）
- 顶部：过滤区（考试批次、科目：默认全科）
- 第一行：指标卡（均分/优秀率/及格率/低分率）
- 第二行：图表（分段构成、学科对比）
- 第三行：临界生表格（支持导出）

### 4.6 教师端 - 通知与审批
#### 4.6.1 通知发布
- 页面：FilterBar（类型）+ Table（已发列表）+ Drawer（发通知）
- Drawer（发通知）：
  - 接收对象：行政班多选（默认全部）
  - 类型：班级通知 / 作业 / 紧急
  - 内容：标题、正文（富文本）、附件
  - 选项：需家长回执（Checkbox）
- 详情页：
  - 统计卡片：已读/未读人数、已回执/未回执人数
  - 列表：学生名单及状态（可一键提醒未读）

#### 4.6.2 审批中心
- 页面 Tabs：待我审批 / 我发起的 / 已处理
- 列表卡片：
  - 申请类型（请假/处分撤销/场地）、申请人、摘要、时间
  - 操作：同意 / 驳回（需填理由）
- 交互：
  - 批量通过（仅限低风险流程）
  - 审批流转：班主任 -> 年级组长 -> 德育处（按低代码流程配置）


## 5. 学生端（H5/小程序）
### 5.1 首页
- 顶部：学校/学期/周数
- Banner：公告轮播（点击进入公告详情）
- 快捷入口（Grid）：成绩查询、德育记录、填报任务、请假申请
- 待办卡片（重要）：
  - 待填报表单（红点提示，显示截止时间）
  - 成绩发布提醒（“期中考成绩已出，点击查看”）
  - 德育预警（“本周扣分已达 N 分，请注意”）

### 5.2 成绩 Tab
- 顶部：学期切换（Picker）
- 核心卡片：最近一次考试
  - 总分大字展示 + 班级排名（若开放）
  - 各科小卡片（科目/分数/单科排名）
  - 进退步提示（比上次 +5名 / -10分）
- 趋势分析：
  - 折线图（总分走势）
  - 雷达图（学科强弱）
  - “我的优势学科”标签

### 5.3 德育 Tab
- 顶部：本学期累计分（仪表盘风格）
- 列表：德育时间轴（无限滚动）
  - 左侧：日期/星期
  - 右侧：事件卡片（来源/项目/分值）
  - 状态：待复核/已生效

### 5.4 填报 Tab（低代码入口）
- 列表：当前有效表单
  - 标题、发起人、截止时间、状态（未填/已填）
- 填写页：
  - 根据 Schema 渲染表单（文本/单选/拍照上传）
  - 提交后显示“提交成功”回执页（含时间戳）

### 5.5 消息 Tab（通知）
- 列表：系统通知、班级通知、作业通知
- 详情：标题、正文、附件下载、确认回执按钮

---

## 6. 分布屏（TV滚动）
- 版式：上部标题条 + 中部两列榜单 + 底部滚动条
- 轮播节奏：
  - 每15秒切一个模块（德育Top班级/临界生/德育预警）
  - 支持配置开关与顺序

# K12 教务管理系统 - 权限矩阵与数据范围（RBAC + Scope）

## 1. 权限模型定义
### 1.1 三层权限
- 菜单权限：决定“看得见哪些菜单/页面”。
- 功能权限：决定“页面内哪些动作可用”（按钮、导入、导出、提交、撤销、审批等）。
- 数据范围权限：决定“能看到/操作哪些数据”（按年级/班级/学科/个人）。

### 1.2 数据范围类型（建议标准化）
- `SELF`：仅本人
- `GRADE`：指定年级（可多选）
- `CLASS`：指定行政班（可多选）
- `SUBJECT`：指定学科（可多选）
- `SUBJECT_CLASS`：学科 + 行政班组合（用于科任老师典型授权）
- `ALL`：全校（仅系统管理员/校级授权）

### 1.3 数据范围的作用域
- 读权限范围：能查询哪些行
- 写权限范围：能写入/更正哪些行（通常比读更收敛）
- 审批范围：能处理哪些申请

## 2. 角色默认权限（可复制后修改）
### 2.1 系统管理员
- 菜单：全开
- 功能：全开（含导入/回滚/权限变更/规则配置/低代码发布/审计）
- 数据范围：`ALL`

### 2.2 校级管理员/领导
- 菜单：工作台、全校分析、审批中心、审计（只读或半只读）
- 功能：导出/查看；不允许直接改成绩（默认关闭）
- 数据范围：`ALL` 或指定 `GRADE`

### 2.3 年级管理员
- 菜单：考务中心、年级分析、德育量化、宿舍量化、审批中心
- 功能：
  - 成绩：创建考试、导入、提交入库、触发计算、导出、回滚（可选开关）
  - 德育：规则配置（可选开关）、事件导入、撤销/更正（需审计）
- 数据范围：`GRADE`（单年级或多年级）

### 2.4 班主任
- 菜单：工作台、班级管理、学生档案360、班级分析、德育管理、审批中心
- 功能：
  - 成绩：仅查看与导出（默认不允许改分）
  - 德育：可录入/发起处置；撤销/更正需上级复核（可配置）
  - 档案：可直接编辑可变字段（座位号、宿舍、走读/住校等），所有变更强审计
- 数据范围：`CLASS`（单班或多班）

### 2.5 科任老师
- 菜单：工作台、成绩分析（任教学科）、德育事件（课堂）、通知发布
- 功能：
  - 成绩：仅查看任教学科；导出可选
  - 德育：可录入课堂事件；撤销/更正需复核（建议）
- 数据范围：`SUBJECT_CLASS`（所授学科与行政班集合）

### 2.6 学生
- 菜单：首页、成绩、德育、填报、我的
- 功能：仅查询本人；表单提交
- 数据范围：`SELF`

## 3. 菜单/功能权限点清单（用于落库）
### 3.1 考务中心（示例）
- 菜单：`EXAM_CENTER_VIEW`
- 功能：
  - 创建考试：`EXAM_CREATE`
  - 配置科目与满分：`EXAM_SUBJECT_CONFIG`
  - 上传成绩：`SCORE_IMPORT_UPLOAD`
  - 提交入库：`SCORE_IMPORT_COMMIT`
  - 回滚导入：`SCORE_IMPORT_ROLLBACK`
  - 触发计算：`ANALYTICS_JOB_TRIGGER`
  - 导出报表：`REPORT_EXPORT`

### 3.2 德育量化（示例）
- 菜单：`MORAL_VIEW`
- 功能：
  - 新增事件：`MORAL_EVENT_CREATE`
  - 导入事件：`MORAL_EVENT_IMPORT`
  - 撤销/更正：`MORAL_EVENT_REVOKE`
  - 复核：`MORAL_EVENT_REVIEW`
  - 规则配置：`MORAL_RULE_CONFIG`

### 3.3 组织与人员（示例）
- 菜单：`ORG_VIEW`
- 功能：
  - 批量导入用户：`USER_IMPORT`
  - 批量重置密码：`USER_PASSWORD_RESET_BATCH`
  - 停用/启用：`USER_STATUS_UPDATE`
  - 分班/升班处理：`ORG_ROLLOVER`
  - 菜单配置：`MENU_CONFIG`
  - 通用CRUD对象配置：`ENTITY_CONFIG`

## 4. 审计日志（强制）
- 登录/登出
- 成绩导入/提交/回滚/更正
- 德育事件新增/撤销/更正/复核
- 权限变更（角色、菜单、功能、数据范围）
- 低代码表单发布与权限变更
